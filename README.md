# Приложение за сливане на поръчки с цени и генериране на седмични протоколи.

## Какво прави

* Качва 2 Excel файла: Поръчка (.xls/.xlsx) и Цени (.xls/.xlsx)
* Чете нужните колони (намира ги по заглавия)
* Слива по "Име на артикул"
* Избира Ед. цена според тираж (количество) от колоните 1000/2000/3000…
* Взима най-малкия тираж ≥ бройки, ако няма — взима най-големия наличен
* Смята Сума = Ед. цена * Бройки
* Показва резултата в таблица
* Записва готов .xlsx (Save As) - съвместим с Numbers за macOS

## Стартиране

```
python3 merge_excel_app.py
```

---

## Основни функционалности

### 1. Сливане на поръчка с цени
- Качи файл с поръчка и файл с цени
- Натисни "Слей" за да се изчислят цените и сумите
- Резултатът се показва в таблицата

### 2. Седмични протоколи
- **Избери папка за протоколи** - избираш къде да се записват протоколите
- При запис на поръчка, редовете автоматично се групират по седмица (ISO week) и се добавят към съответния протокол (`protocol_2026_w7.xlsx`, `protocol_2026_w8.xlsx` и т.н.)
- **Преглед протоколи** - показва списък на всички протоколи със статус, брой редове и поръчки
- **Приключи протокол** - маркира протокол като затворен (не могат да се добавят нови редове)
- **Отвори протокол** - отваря затворен протокол за добавяне на редове

### 3. Качване на много поръчки
- Бутон **"Качи много поръчки"** - избираш няколко поръчки наведнъж
- Всички се обработват и добавят към седмичните протоколи автоматично
- Изисква избрана папка за протоколи

### 4. Търсене
- **Търси** - търси в текущото сливане по Артикул, Технологичен лист, Размер
- **Търси навсякъде** - търси във всички протоколи в избраната папка

### 5. Ръчна редакция
- Двоен клик върху ред отваря диалог за редакция
- Промените остават в паметта - използвай "Запази .xlsx" за да ги запишеш

### 6. Съвместимост
- Записаните .xlsx файлове са съвместими с:
  - Microsoft Excel
  - Apple Numbers (macOS)
  - LibreOffice Calc
- Датите се записват като реални Excel дати с формат YYYY-MM-DD

---

## Бележки

- **Няма автоматично локално копие** - файловете се записват само там, където потребителят избере
- **Протоколите се записват в избраната папка** - няма твърдо зададен път
- При затворен протокол се показва предупреждение и редовете не се добавят

---

## GitHub Actions

1. Качваш в GitHub
2. Пускаш workflow (Actions → Build Windows EXE → Run)
3. Сваляш MergeOrders.exe от "Artifacts"
